import json
import psycopg2
from bottle import route, run, request
import config


connection_string = config.conf()


def getPolygon(polygon):
    polygonJSON = json.loads(polygon)
    polygon_collection = []
    for feature in polygonJSON['features']:
        for obj in feature['geometry']['coordinates']:
            new_polygon = "ST_GeomFromText('POLYGON(("
            for point in obj:
                longitude = point[0]
                latitude = point[1]
                new_polygon += '%s %s,' % (longitude, latitude)
            new_polygon = new_polygon[:-1]
            new_polygon += "))')"
            polygon_collection.append(new_polygon)
    return polygon_collection


def union(polygon_collection):
    conn = psycopg2.connect(connection_string)
    cur = conn.cursor()
    selectQuery = "SELECT ST_AsText(ST_Union(st_geomfromtext)) FROM ("
    for polygon in polygon_collection:
        selectQuery += "SELECT %s UNION ALL " % (polygon,)
    selectQuery = selectQuery[:-10]
    selectQuery += ") as a;"
    cur.execute(selectQuery)
    rows = cur.fetchall()
    conn.commit()
    cur.close()
    conn.close()
    #in terms of POLYGON
    if rows[0][0][0] == 'P':
        multi_polygon = rows[0][0][9:-2]
    #in terms of MULTIPOLYGON
    else:
        multi_polygon = rows[0][0][15:-3]
    multi_polygons = multi_polygon.split(')),((')
    union_walkshed = '{"type": "FeatureCollection", "features": ['
    for polygon in multi_polygons:
        #to ignore polygon in polygon effect
        polygons = polygon.split('),(')
        polygon_items = polygons[0].split(',')
        union_walkshed += '{"type": "Feature","geometry": {"type":"Polygon","coordinates":[['
        for item in polygon_items:
            location = item.split()
            longitude = location[0]
            latitude = location[1]
            #print longitude, latitude
            union_walkshed += '[%s,%s],' % (longitude, latitude)
        union_walkshed = union_walkshed[:-1]
        union_walkshed += ']]}},'
    union_walkshed = union_walkshed[:-1]
    union_walkshed += ']}'
    return union_walkshed


@route('/union', method='POST')
def service():
    walkshed_collection = request.POST.get('walkshed_collection', default=None)
    if walkshed_collection is not None:
        polygon_collection = getPolygon(walkshed_collection)
        return union(polygon_collection)

@route('/union', method='GET')
def service():
    walkshed_collection = request.GET.get('walkshed_collection', default=None)
    if walkshed_collection is not None:
        polygon_collection = getPolygon(walkshed_collection)
        return union(polygon_collection)


run(host='0.0.0.0', port=9368, debug=True)


#http://127.0.0.1:9368/union?walkshed_collection={"type": "FeatureCollection", "features": [{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0652781056286, 51.06335667337138], [-114.06502068358164, 51.06351633741463], [-114.06358968892968, 51.06440983937841], [-114.062644, 51.065015], [-114.06252009700455, 51.065039165611964], [-114.06147672871987, 51.06439915995715], [-114.06051650171892, 51.06376938775646], [-114.05992637263992, 51.06338544973436], [-114.05982866675319, 51.06332278189777], [-114.0599931694359, 51.062435525538], [-114.06180912824452, 51.06123371321675], [-114.062544461198, 51.060864507186864], [-114.06329649462735, 51.06134011058328], [-114.06365053035228, 51.061565450519765], [-114.06501212083745, 51.06241776831422], [-114.06507139414866, 51.062454936550694], [-114.0652781056286, 51.06335667337138]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0651619510021, 51.06069367536461], [-114.06446018248323, 51.060231781351554], [-114.062695, 51.059034], [-114.0625234735182, 51.059027047997155], [-114.06176587653701, 51.05949217437942], [-114.0613349235387, 51.05975832021982], [-114.05993651712208, 51.06061868089061], [-114.05989650705307, 51.06064346923559], [-114.05989300783743, 51.061538778411624], [-114.05993201111707, 51.06156381933559], [-114.06131620158935, 51.062441485142294], [-114.06254783468695, 51.06321330421346], [-114.06328798139975, 51.06275983199761], [-114.06447721861326, 51.06201754508283], [-114.06500849007368, 51.06167218447171], [-114.0651619510021, 51.06069367536461]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06500229365179, 51.0591018754272], [-114.06461277902103, 51.05978280837327], [-114.06388756397452, 51.06022844814486], [-114.06329971530893, 51.06059730774494], [-114.06317343299845, 51.06067744377275], [-114.06254750849432, 51.06106932243629], [-114.06175864248594, 51.060571839051896], [-114.06048611045524, 51.05974487337674], [-114.05954879423489, 51.05885661650239], [-114.06019221468596, 51.058420842273186], [-114.06243979354409, 51.057383366846366], [-114.0632327795571, 51.05765442072165], [-114.06390878260869, 51.05800006521739], [-114.06499123103448, 51.058711737931034], [-114.06500229365179, 51.0591018754272]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06375755411383, 51.0568530132763], [-114.06262800184643, 51.05410680745991], [-114.0625094572884, 51.05394377857916], [-114.06115462589577, 51.05498253249509], [-114.06243398007105, 51.05721653654614], [-114.06375755411383, 51.0568530132763]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06542233316831, 51.04940656806797], [-114.06537396142447, 51.048456710006974], [-114.063772, 51.046523], [-114.06294931439217, 51.046790825250895], [-114.06186051545488, 51.047414600498165], [-114.06042002285979, 51.04825017411887], [-114.06031846944994, 51.0483097727437], [-114.06013030538736, 51.049254921483], [-114.06031497478057, 51.04938465615421], [-114.06155983882056, 51.050242818234246], [-114.06264264422529, 51.05098978177965], [-114.06384749696346, 51.05030836675169], [-114.06523535343706, 51.049513637589634], [-114.06542233316831, 51.04940656806797]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0652781056286, 51.06335667337138], [-114.06502068358164, 51.06351633741463], [-114.06358968892968, 51.06440983937841], [-114.062644, 51.065015], [-114.06252009700455, 51.065039165611964], [-114.06147672871987, 51.06439915995715], [-114.06051650171892, 51.06376938775646], [-114.05992637263992, 51.06338544973436], [-114.05982866675319, 51.06332278189777], [-114.0599931694359, 51.062435525538], [-114.06180912824452, 51.06123371321675], [-114.062544461198, 51.060864507186864], [-114.06329649462735, 51.06134011058328], [-114.06365053035228, 51.061565450519765], [-114.06501212083745, 51.06241776831422], [-114.06507139414866, 51.062454936550694], [-114.0652781056286, 51.06335667337138]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0651619510021, 51.06069367536461], [-114.06446018248323, 51.060231781351554], [-114.062695, 51.059034], [-114.0625234735182, 51.059027047997155], [-114.06176587653701, 51.05949217437942], [-114.0613349235387, 51.05975832021982], [-114.05993651712208, 51.06061868089061], [-114.05989650705307, 51.06064346923559], [-114.05989300783743, 51.061538778411624], [-114.05993201111707, 51.06156381933559], [-114.06131620158935, 51.062441485142294], [-114.06254783468695, 51.06321330421346], [-114.06328798139975, 51.06275983199761], [-114.06447721861326, 51.06201754508283], [-114.06500849007368, 51.06167218447171], [-114.0651619510021, 51.06069367536461]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06500229365179, 51.0591018754272], [-114.06461277902103, 51.05978280837327], [-114.06388756397452, 51.06022844814486], [-114.06329971530893, 51.06059730774494], [-114.06317343299845, 51.06067744377275], [-114.06254750849432, 51.06106932243629], [-114.06175864248594, 51.060571839051896], [-114.06048611045524, 51.05974487337674], [-114.05954879423489, 51.05885661650239], [-114.06019221468596, 51.058420842273186], [-114.06243979354409, 51.057383366846366], [-114.0632327795571, 51.05765442072165], [-114.06390878260869, 51.05800006521739], [-114.06499123103448, 51.058711737931034], [-114.06500229365179, 51.0591018754272]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06375755411383, 51.0568530132763], [-114.06262800184643, 51.05410680745991], [-114.0625094572884, 51.05394377857916], [-114.06115462589577, 51.05498253249509], [-114.06243398007105, 51.05721653654614], [-114.06375755411383, 51.0568530132763]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06542233316831, 51.04940656806797], [-114.06537396142447, 51.048456710006974], [-114.063772, 51.046523], [-114.06294931439217, 51.046790825250895], [-114.06186051545488, 51.047414600498165], [-114.06042002285979, 51.04825017411887], [-114.06031846944994, 51.0483097727437], [-114.06013030538736, 51.049254921483], [-114.06031497478057, 51.04938465615421], [-114.06155983882056, 51.050242818234246], [-114.06264264422529, 51.05098978177965], [-114.06384749696346, 51.05030836675169], [-114.06523535343706, 51.049513637589634], [-114.06542233316831, 51.04940656806797]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0655771380036, 51.04751843022492], [-114.0653148, 51.048455], [-114.06372247278152, 51.04936632489803], [-114.06273577896671, 51.049921844080025], [-114.0618423522182, 51.04930979327018], [-114.0604171, 51.0483122], [-114.06018498334097, 51.047371798986305], [-114.06047066195778, 51.047206962402576], [-114.06302563413219, 51.04574407282529], [-114.063454697404, 51.0460415037761], [-114.06487433665852, 51.04700535696188], [-114.0655771380036, 51.04751843022492]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06069771348191, 51.0473863508306], [-114.0604539851365, 51.04752946211471], [-114.05914921882062, 51.04828099797812], [-114.05787620437279, 51.049019716172104], [-114.05544370418417, 51.0480482549795], [-114.05420460597905, 51.047195013185856], [-114.05556203651395, 51.046411046204106], [-114.05811267276263, 51.045578855344345], [-114.0604692816781, 51.04723176777364], [-114.06069771348191, 51.0473863508306]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0634975753058, 51.047457451736676], [-114.06288970254056, 51.04781217755912], [-114.06195495237448, 51.04836108853623], [-114.06034721557879, 51.049261437640205], [-114.06032624747806, 51.04927318561542], [-114.057938409169, 51.04800835132044], [-114.05689832864181, 51.047270263893225], [-114.05804467885329, 51.04659595699805], [-114.05989577823713, 51.04574844578016], [-114.06060226387852, 51.04549149602149], [-114.06293314352517, 51.0470680727085], [-114.0634975753058, 51.047457451736676]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06846799867735, 51.04760037532791], [-114.06846799867735, 51.04760037532792], [-114.06779733659455, 51.04799005807317], [-114.06693187893579, 51.0485017401907], [-114.06532370363037, 51.049404085807986], [-114.06524060152758, 51.04945167226206], [-114.06516587114564, 51.04940056181339], [-114.06369745429235, 51.048412097832596], [-114.06229449017172, 51.047425143687605], [-114.06304530548609, 51.04695505226057], [-114.0645871484445, 51.046072471037014], [-114.06538374219272, 51.045619166385514], [-114.06548799282281, 51.045560550211604], [-114.06632295039405, 51.046115142342714], [-114.06773954287573, 51.04707739750274], [-114.06846799867735, 51.04760037532791]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0653148, 51.048455], [-114.06277516727344, 51.049489084242396], [-114.06255211305455, 51.049332748317546], [-114.06108995495252, 51.04833359015049], [-114.06266928651809, 51.0474342491694], [-114.06291685741007, 51.0472912290834], [-114.0653148, 51.048455]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0653148, 51.048455], [-114.06277516727344, 51.049489084242396], [-114.06255211305455, 51.049332748317546], [-114.06108995495252, 51.04833359015049], [-114.06266928651809, 51.0474342491694], [-114.06291685741007, 51.0472912290834], [-114.0653148, 51.048455]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05997771544104, 51.048301386931044], [-114.05839772545413, 51.049203271995914], [-114.05784441167361, 51.04952222931054], [-114.05488339178389, 51.049065968161344], [-114.05344403058908, 51.04839453631125], [-114.0534163161339, 51.04806022348067], [-114.05552825680853, 51.046907442444045], [-114.05800747945682, 51.04696719015697], [-114.05997771544104, 51.048301386931044]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05246636223974, 51.05191038897178], [-114.05177679623657, 51.05125559448215], [-114.05042331936893, 51.05037815029655], [-114.0495091179135, 51.05056085157873], [-114.048371885611, 51.051549092316286], [-114.04835418666667, 51.05221124444444], [-114.04872831396044, 51.05326225251824], [-114.05069456006633, 51.05439321008712], [-114.05171671276408, 51.05338668304271], [-114.05246636223974, 51.05191038897178]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05274249655173, 51.053478873275864], [-114.05250434473683, 51.05287220789474], [-114.05170959675132, 51.052363190130734], [-114.05028743779081, 51.05147724159902], [-114.04957020451964, 51.05191045910603], [-114.04757453995279, 51.0532617], [-114.04837501100846, 51.05380773449376], [-114.05188257816008, 51.05523533121169], [-114.05274249655173, 51.053478873275864]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0537841, 51.0552637], [-114.05350054351145, 51.0557297908397], [-114.05312542142858, 51.056216164285715], [-114.0515486104, 51.056327576], [-114.05098130912205, 51.05607460173754], [-114.0503428, 51.0538939], [-114.0502741, 51.053597], [-114.05027353667474, 51.05355345364711], [-114.05171841730798, 51.053585465886435], [-114.051821, 51.053606], [-114.05243017053115, 51.05406124520018], [-114.05276022408759, 51.054361027007296], [-114.0537841, 51.0552637]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0573774907624, 51.05795965129121], [-114.05638499606209, 51.05883393395226], [-114.05459935333725, 51.06006186364933], [-114.054447, 51.060122], [-114.05356764541466, 51.0596644571164], [-114.05284565645282, 51.05917824665002], [-114.0516943457313, 51.05841902024304], [-114.05351724285714, 51.05651412857143], [-114.05429744587559, 51.05626983864459], [-114.05590736567164, 51.05705870074627], [-114.05665937413981, 51.05750767903864], [-114.0573774907624, 51.05795965129121]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05096124122646, 51.04519892644647], [-114.05074586006849, 51.04505658671807], [-114.04934361613458, 51.044186182690666], [-114.048536, 51.043998], [-114.048012, 51.043939], [-114.04740623999194, 51.04392435147584], [-114.04832, 51.0469146], [-114.04892975687333, 51.04737922531411], [-114.0506797, 51.0461406], [-114.05096124122646, 51.04519892644647]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06069771348191, 51.0473863508306], [-114.0604539851365, 51.04752946211471], [-114.05914921882062, 51.04828099797812], [-114.05787620437279, 51.049019716172104], [-114.05544370418417, 51.0480482549795], [-114.05420460597905, 51.047195013185856], [-114.05556203651395, 51.046411046204106], [-114.05811267276263, 51.045578855344345], [-114.0604692816781, 51.04723176777364], [-114.06069771348191, 51.0473863508306]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06255196909024, 51.04743139900366], [-114.06220267199406, 51.04550667282134], [-114.06081621496712, 51.04454577009734], [-114.06066437153105, 51.04444298606299], [-114.06050074964106, 51.04453643449383], [-114.05900896311408, 51.04540780159941], [-114.05837115958163, 51.047313963753446], [-114.0598253166997, 51.048297636462195], [-114.06038199449159, 51.04868386389815], [-114.06100858168249, 51.04833100328317], [-114.06255196909024, 51.04743139900366]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06846799867735, 51.04760037532791], [-114.06846799867735, 51.04760037532792], [-114.06779733659455, 51.04799005807317], [-114.06535123781083, 51.047698473998196], [-114.0650644123471, 51.04750367413167], [-114.06430750085491, 51.04698976701119], [-114.064383, 51.046574], [-114.06543568168993, 51.04636615439274], [-114.0679294356503, 51.046150782152], [-114.06846799867735, 51.04760037532791]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.074858, 51.046765], [-114.0748519897461, 51.046783447265625], [-114.07381567032719, 51.046680055171734], [-114.07336915953125, 51.0458529491985], [-114.07391093004206, 51.04554644406447], [-114.07439458108209, 51.045882320936535], [-114.074858, 51.046765]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0717993, 51.0462089], [-114.0717989803411, 51.04621470924657], [-114.06952081173468, 51.04812231622247], [-114.06943878083987, 51.04817010373096], [-114.06689789275116, 51.04697341658521], [-114.0661998, 51.0461152], [-114.06899978595672, 51.04487502726978], [-114.07055803462102, 51.04520943232315], [-114.0717993, 51.0462089]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06178895332893, 51.04549026875655], [-114.0615656629156, 51.04740743720948], [-114.06042826397034, 51.04807528986867], [-114.05935693336389, 51.047345395945214], [-114.05942324304746, 51.04541703081438], [-114.06064942561535, 51.044699243018336], [-114.06178895332893, 51.04549026875655]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05667877197266, 51.04625701904297], [-114.05562462016941, 51.04723351386557], [-114.0555006094713, 51.04730447772541], [-114.05538796417991, 51.04722691028962], [-114.05557429260855, 51.04621662333413], [-114.05667877197266, 51.04625701904297]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06170331118155, 51.03852826888856], [-114.06037493612199, 51.039441935093905], [-114.05876566288708, 51.04035662424804], [-114.05845991573761, 51.04053575550971], [-114.058209, 51.038395], [-114.05881499781941, 51.036429027439674], [-114.05969236132182, 51.03701460823255], [-114.06094762175356, 51.0378419844939], [-114.06170331118155, 51.03852826888856]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05951750164402, 51.03129684355321], [-114.05949918334572, 51.032325266358875], [-114.0594975, 51.0325898], [-114.05949525774305, 51.032666282598115], [-114.0594747, 51.0333675], [-114.0594098, 51.0336912], [-114.0593218, 51.0340062], [-114.05836, 51.032633], [-114.05951750164402, 51.03129684355321]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0614076084121, 51.03784052336118], [-114.06121048994596, 51.03851290256937], [-114.05988202320363, 51.03942851086914], [-114.05847874767498, 51.04022949915568], [-114.058209, 51.038395], [-114.05883098020594, 51.03613845452978], [-114.0596463, 51.0362043], [-114.0598671, 51.0362559], [-114.0614076084121, 51.03784052336118]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06122022136175, 51.04137364738734], [-114.06055560469562, 51.04230599450993], [-114.05898093307964, 51.04320363773757], [-114.05825990956482, 51.04361623442866], [-114.0576008001795, 51.04316184803228], [-114.0561399336781, 51.04216389488436], [-114.05555486291487, 51.041206065241994], [-114.05555486291487, 51.04120606524199], [-114.05598587873064, 51.040956593178606], [-114.05853532080995, 51.0394695097051], [-114.05987021766552, 51.04038247477406], [-114.06122022136175, 51.04137364738734]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06019599966693, 51.04543424607485], [-114.05955123805161, 51.04735159150683], [-114.05798537833003, 51.04825235635378], [-114.05792378085674, 51.04828810078252], [-114.05786704326648, 51.04824913168292], [-114.0564250479642, 51.04725660843095], [-114.05764801959913, 51.04443711993759], [-114.05822499234814, 51.04410515245707], [-114.05875197625627, 51.0444724792716], [-114.06019599966693, 51.04543424607485]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0634975753058, 51.047457451736676], [-114.06288970254056, 51.04781217755912], [-114.06195495237448, 51.04836108853623], [-114.06034721557879, 51.049261437640205], [-114.06032624747806, 51.04927318561542], [-114.057938409169, 51.04800835132044], [-114.05689832864181, 51.047270263893225], [-114.05804467885329, 51.04659595699805], [-114.05989577823713, 51.04574844578016], [-114.06060226387852, 51.04549149602149], [-114.06293314352517, 51.0470680727085], [-114.0634975753058, 51.047457451736676]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06846799867735, 51.04760037532791], [-114.06846799867735, 51.04760037532792], [-114.06779733659455, 51.04799005807317], [-114.06693187893579, 51.0485017401907], [-114.06532370363037, 51.049404085807986], [-114.06524060152758, 51.04945167226206], [-114.06516587114564, 51.04940056181339], [-114.06369745429235, 51.048412097832596], [-114.06229449017172, 51.047425143687605], [-114.06304530548609, 51.04695505226057], [-114.0645871484445, 51.046072471037014], [-114.06538374219272, 51.045619166385514], [-114.06548799282281, 51.045560550211604], [-114.06632295039405, 51.046115142342714], [-114.06773954287573, 51.04707739750274], [-114.06846799867735, 51.04760037532791]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.07213705754833, 51.04771305844104], [-114.07154793053498, 51.04806901516164], [-114.07020243922405, 51.048827525141675], [-114.06772849935945, 51.04903412678483], [-114.0669626605321, 51.04850262990465], [-114.0654901468704, 51.0475160121327], [-114.06633043108042, 51.04704270161587], [-114.06790977158195, 51.04614976949221], [-114.06793119362749, 51.04613783514247], [-114.07037963784367, 51.04647760725518], [-114.07213705754833, 51.04771305844104]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.07213705754833, 51.04771305844104], [-114.07154793053498, 51.04806901516164], [-114.07020243922405, 51.048827525141675], [-114.06772849935945, 51.04903412678483], [-114.0669626605321, 51.04850262990465], [-114.0654901468704, 51.0475160121327], [-114.06633043108042, 51.04704270161587], [-114.06790977158195, 51.04614976949221], [-114.06793119362749, 51.04613783514247], [-114.07037963784367, 51.04647760725518], [-114.07213705754833, 51.04771305844104]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0780054402717, 51.047876663759574], [-114.07722216035366, 51.048313516238885], [-114.07641704513573, 51.04877835287388], [-114.07612846734527, 51.04894336993913], [-114.07586489745327, 51.048762019944434], [-114.074464, 51.047845], [-114.074462890625, 51.04784393310547], [-114.074462, 51.047843], [-114.07441612857225, 51.04777621416093], [-114.07628061916942, 51.04669713467912], [-114.0780054402717, 51.047876663759574]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.08530794719906, 51.0480790794231], [-114.0835059, 51.0489783], [-114.08100435736952, 51.04965969126577], [-114.0805921700856, 51.04937547724968], [-114.07985477503199, 51.04887645890434], [-114.07911940248499, 51.04836202672578], [-114.078490708105, 51.047890309078724], [-114.07867397438748, 51.04778365779815], [-114.08123555046222, 51.04633939272992], [-114.08363660476249, 51.04705931141823], [-114.08530794719906, 51.0480790794231]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06556615489164, 51.04466258507163], [-114.06396964338839, 51.0455713359762], [-114.06299416117419, 51.046115816154625], [-114.06058779429654, 51.045641606265626], [-114.0603461976635, 51.04551071031638], [-114.05890453975685, 51.044478058743856], [-114.06072483328296, 51.04343844495072], [-114.06556615489164, 51.04466258507163]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06069771348191, 51.0473863508306], [-114.0604539851365, 51.04752946211471], [-114.05914921882062, 51.04828099797812], [-114.05787620437279, 51.049019716172104], [-114.05544370418417, 51.0480482549795], [-114.05420460597905, 51.047195013185856], [-114.05556203651395, 51.046411046204106], [-114.05811267276263, 51.045578855344345], [-114.0604692816781, 51.04723176777364], [-114.06069771348191, 51.0473863508306]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.076141, 51.0487698], [-114.0737213976648, 51.047694781161255], [-114.07361689040862, 51.04775397359316], [-114.07286570616485, 51.04819000470454], [-114.07205375968952, 51.0486556306856], [-114.07349264749625, 51.049638401927815], [-114.07358735000187, 51.049702503390854], [-114.076141, 51.0487698]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0677712, 51.048526], [-114.065578, 51.047305], [-114.06538096720465, 51.04719258504844], [-114.06480806304792, 51.04749611171244], [-114.0632438085451, 51.04840006429784], [-114.06471203023301, 51.04939171724039], [-114.06521646031116, 51.049736712768905], [-114.0677712, 51.048526]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06579712541253, 51.04941600065591], [-114.06521541069306, 51.04974910583442], [-114.06422209079632, 51.05032060758414], [-114.06262254491979, 51.05122524477643], [-114.06118502739972, 51.0502335862765], [-114.06029117686366, 51.049619982847204], [-114.05975563562335, 51.04924375230069], [-114.0608730783356, 51.04832669561333], [-114.06245229915966, 51.047428977574675], [-114.06292681003596, 51.04715485574318], [-114.06485649654233, 51.0484428429135], [-114.06579712541253, 51.04941600065591]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05750964951704, 51.047287902198654], [-114.057467, 51.047398], [-114.05542932500946, 51.04848665213617], [-114.0528497, 51.0488124], [-114.05217248118934, 51.04858725844714], [-114.05051770473172, 51.04707206838729], [-114.053017, 51.045568], [-114.05320194040162, 51.04558280617073], [-114.05559823605984, 51.04596486720572], [-114.056726, 51.046255], [-114.05750964951704, 51.047287902198654]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06320286048788, 51.0493520532563], [-114.06276501772852, 51.049600597424195], [-114.0615926572652, 51.0502436265834], [-114.06008601787237, 51.05105132376133], [-114.0578227497055, 51.04986945970665], [-114.05678052518286, 51.049157924551245], [-114.05790965095962, 51.04850538565378], [-114.06045743546512, 51.04745624284038], [-114.06177750786972, 51.04835544755128], [-114.06320286048788, 51.0493520532563]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.07090243204976, 51.04957205160854], [-114.07014522704817, 51.05000235122067], [-114.06934277466719, 51.05046907022743], [-114.06773212841512, 51.051381875785665], [-114.06754603541214, 51.05148746268781], [-114.0673772715449, 51.051369926511235], [-114.06588977493395, 51.05037144290312], [-114.06520176565768, 51.04991021568611], [-114.0644510541891, 51.049386317584606], [-114.06445381107983, 51.04938161072844], [-114.06599635726559, 51.04847469979069], [-114.06756091872302, 51.04757357337055], [-114.0678276049409, 51.04741949208078], [-114.0680736358426, 51.04758845088675], [-114.06954628894468, 51.04857385351219], [-114.07090243204976, 51.04957205160854]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05710923027358, 51.04442230801095], [-114.0566303416093, 51.0472625317229], [-114.05545223997724, 51.04793668839138], [-114.05438210970918, 51.047199797751425], [-114.05438751025754, 51.04435146085199], [-114.0557485, 51.0443849], [-114.05710923027358, 51.04442230801095]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06069771348191, 51.0473863508306], [-114.0604539851365, 51.04752946211471], [-114.05914921882062, 51.04828099797812], [-114.05787620437279, 51.049019716172104], [-114.05544370418417, 51.0480482549795], [-114.05420460597905, 51.047195013185856], [-114.05556203651395, 51.046411046204106], [-114.05811267276263, 51.045578855344345], [-114.0604692816781, 51.04723176777364], [-114.06069771348191, 51.0473863508306]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06795532699216, 51.047584873554406], [-114.06781306533824, 51.04766753353067], [-114.06641914659029, 51.04848692013024], [-114.065363, 51.049126], [-114.06526390525825, 51.04914360585588], [-114.06421027122404, 51.048425700958845], [-114.06280736938254, 51.04743760382058], [-114.06355807235467, 51.04696915512801], [-114.0650999107273, 51.04608649269696], [-114.06546781296991, 51.04587295642901], [-114.06688, 51.046574], [-114.06795532699216, 51.047584873554406]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0652781056286, 51.06335667337138], [-114.06502068358164, 51.06351633741463], [-114.06358968892968, 51.06440983937841], [-114.062644, 51.065015], [-114.06252009700455, 51.065039165611964], [-114.06147672871987, 51.06439915995715], [-114.06051650171892, 51.06376938775646], [-114.05992637263992, 51.06338544973436], [-114.05982866675319, 51.06332278189777], [-114.0599931694359, 51.062435525538], [-114.06180912824452, 51.06123371321675], [-114.062544461198, 51.060864507186864], [-114.06329649462735, 51.06134011058328], [-114.06365053035228, 51.061565450519765], [-114.06501212083745, 51.06241776831422], [-114.06507139414866, 51.062454936550694], [-114.0652781056286, 51.06335667337138]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0651619510021, 51.06069367536461], [-114.06446018248323, 51.060231781351554], [-114.062695, 51.059034], [-114.0625234735182, 51.059027047997155], [-114.06176587653701, 51.05949217437942], [-114.0613349235387, 51.05975832021982], [-114.05993651712208, 51.06061868089061], [-114.05989650705307, 51.06064346923559], [-114.05989300783743, 51.061538778411624], [-114.05993201111707, 51.06156381933559], [-114.06131620158935, 51.062441485142294], [-114.06254783468695, 51.06321330421346], [-114.06328798139975, 51.06275983199761], [-114.06447721861326, 51.06201754508283], [-114.06500849007368, 51.06167218447171], [-114.0651619510021, 51.06069367536461]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06500229365179, 51.0591018754272], [-114.06461277902103, 51.05978280837327], [-114.06388756397452, 51.06022844814486], [-114.06329971530893, 51.06059730774494], [-114.06317343299845, 51.06067744377275], [-114.06254750849432, 51.06106932243629], [-114.06175864248594, 51.060571839051896], [-114.06048611045524, 51.05974487337674], [-114.05954879423489, 51.05885661650239], [-114.06019221468596, 51.058420842273186], [-114.06243979354409, 51.057383366846366], [-114.0632327795571, 51.05765442072165], [-114.06390878260869, 51.05800006521739], [-114.06499123103448, 51.058711737931034], [-114.06500229365179, 51.0591018754272]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06375755411383, 51.0568530132763], [-114.06262800184643, 51.05410680745991], [-114.0625094572884, 51.05394377857916], [-114.06115462589577, 51.05498253249509], [-114.06243398007105, 51.05721653654614], [-114.06375755411383, 51.0568530132763]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06542233316831, 51.04940656806797], [-114.06537396142447, 51.048456710006974], [-114.063772, 51.046523], [-114.06294931439217, 51.046790825250895], [-114.06186051545488, 51.047414600498165], [-114.06042002285979, 51.04825017411887], [-114.06031846944994, 51.0483097727437], [-114.06013030538736, 51.049254921483], [-114.06031497478057, 51.04938465615421], [-114.06155983882056, 51.050242818234246], [-114.06264264422529, 51.05098978177965], [-114.06384749696346, 51.05030836675169], [-114.06523535343706, 51.049513637589634], [-114.06542233316831, 51.04940656806797]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0655771380036, 51.04751843022492], [-114.0653148, 51.048455], [-114.06372247278152, 51.04936632489803], [-114.06273577896671, 51.049921844080025], [-114.0618423522182, 51.04930979327018], [-114.0604171, 51.0483122], [-114.06018498334097, 51.047371798986305], [-114.06047066195778, 51.047206962402576], [-114.06302563413219, 51.04574407282529], [-114.063454697404, 51.0460415037761], [-114.06487433665852, 51.04700535696188], [-114.0655771380036, 51.04751843022492]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0655771380036, 51.04751843022492], [-114.0653148, 51.048455], [-114.06372247278152, 51.04936632489803], [-114.06273577896671, 51.049921844080025], [-114.0618423522182, 51.04930979327018], [-114.0604171, 51.0483122], [-114.06018498334097, 51.047371798986305], [-114.06047066195778, 51.047206962402576], [-114.06302563413219, 51.04574407282529], [-114.063454697404, 51.0460415037761], [-114.06487433665852, 51.04700535696188], [-114.0655771380036, 51.04751843022492]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.068904, 51.046606], [-114.06533325716748, 51.04807179017475], [-114.06445311786443, 51.04748564067044], [-114.06369612497313, 51.046972952053856], [-114.06296945339133, 51.04642459518664], [-114.06278708844539, 51.04552984510275], [-114.06434772255419, 51.044630357464186], [-114.06561895039523, 51.04389384485172], [-114.06679154702852, 51.04471485169694], [-114.067991, 51.0457012], [-114.068904, 51.046606]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0673372, 51.0480352], [-114.06690776932219, 51.048999321891515], [-114.0662975775437, 51.04935014981821], [-114.06358016720432, 51.04910290127718], [-114.0631275, 51.0478497], [-114.06345887530655, 51.047077652783784], [-114.06358963434528, 51.0469930279836], [-114.0664874, 51.0477143], [-114.0673372, 51.0480352]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06255196909024, 51.04743139900366], [-114.06220267199406, 51.04550667282134], [-114.06081621496712, 51.04454577009734], [-114.06066437153105, 51.04444298606299], [-114.06050074964106, 51.04453643449383], [-114.05900896311408, 51.04540780159941], [-114.05837115958163, 51.047313963753446], [-114.0598253166997, 51.048297636462195], [-114.06038199449159, 51.04868386389815], [-114.06100858168249, 51.04833100328317], [-114.06255196909024, 51.04743139900366]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06385137401966, 51.045567335638815], [-114.0624929989928, 51.044583702381566], [-114.06072781904848, 51.04338883798222], [-114.05882571457738, 51.04447517599077], [-114.05816465278426, 51.044892314345105], [-114.0581246, 51.0453881], [-114.058093556487, 51.04588458680824], [-114.0602835607192, 51.04737494220548], [-114.06045573885238, 51.04749224658603], [-114.06063853511144, 51.04738491312295], [-114.06300010873916, 51.04604148802209], [-114.06385137401966, 51.045567335638815]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06352993777172, 51.04238383801334], [-114.06320601718623, 51.04331908488265], [-114.06109239115958, 51.044552017767685], [-114.06064280727436, 51.044815057559944], [-114.06022486151292, 51.044526344858035], [-114.0582909, 51.0431823], [-114.05813077562911, 51.042229820033285], [-114.05966366476375, 51.041315771764424], [-114.06094254107357, 51.04059569269878], [-114.06210757202523, 51.04139839047147], [-114.06328459875061, 51.042215310235605], [-114.06352993777172, 51.04238383801334]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.060885, 51.0413643], [-114.05835351018459, 51.042158953399266], [-114.05700067720177, 51.04123778416613], [-114.05846854445942, 51.04037333355341], [-114.060885, 51.0413643]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0584211, 51.0412664], [-114.05589389691838, 51.04221788556521], [-114.05579988557872, 51.04215342469404], [-114.0543716141002, 51.04117482307623], [-114.05597105354745, 51.0402710304347], [-114.05603329014818, 51.04023448739998], [-114.0584211, 51.0412664]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.055969, 51.041217], [-114.0534433111397, 51.04210669172139], [-114.05342484448505, 51.042096831027145], [-114.05197676926583, 51.04110882670714], [-114.0535802, 51.0401995], [-114.055969, 51.041217]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0535148, 51.0411522], [-114.05103937418173, 51.04200017491287], [-114.051, 51.0419991], [-114.05096056870151, 51.041997905349085], [-114.04953984400312, 51.04103057439258], [-114.051122, 51.0401314], [-114.0535148, 51.0411522]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05400782033945, 51.041165217569066], [-114.05255528017815, 51.042041559058525], [-114.051, 51.0419991], [-114.04944246370992, 51.04195191128898], [-114.04846365851242, 51.041783156742646], [-114.04712053174106, 51.040957441122636], [-114.04836574380306, 51.040189190943906], [-114.05118314396483, 51.039188976863535], [-114.05262061590346, 51.04017291645229], [-114.05400782033945, 51.041165217569066]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.074858, 51.046765], [-114.0748519897461, 51.046783447265625], [-114.07381567032719, 51.046680055171734], [-114.07336915953125, 51.0458529491985], [-114.07391093004206, 51.04554644406447], [-114.07439458108209, 51.045882320936535], [-114.074858, 51.046765]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.0717993, 51.0462089], [-114.0717989803411, 51.04621470924657], [-114.06952081173468, 51.04812231622247], [-114.06943878083987, 51.04817010373096], [-114.06689789275116, 51.04697341658521], [-114.0661998, 51.0461152], [-114.06899978595672, 51.04487502726978], [-114.07055803462102, 51.04520943232315], [-114.0717993, 51.0462089]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.06178895332893, 51.04549026875655], [-114.0615656629156, 51.04740743720948], [-114.06042826397034, 51.04807528986867], [-114.05935693336389, 51.047345395945214], [-114.05942324304746, 51.04541703081438], [-114.06064942561535, 51.044699243018336], [-114.06178895332893, 51.04549026875655]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.05667877197266, 51.04625701904297], [-114.05562462016941, 51.04723351386557], [-114.0555006094713, 51.04730447772541], [-114.05538796417991, 51.04722691028962], [-114.05557429260855, 51.04621662333413], [-114.05667877197266, 51.04625701904297]]]}},{"type": "Feature","geometry": {"type": "Polygon", "coordinates": [[[-114.04223338273849, 51.048876421582904], [-114.0398884, 51.049363], [-114.0396929, 51.0493934], [-114.0394854, 51.0492998], [-114.03815264822812, 51.04801754940937], [-114.04223338273849, 51.048876421582904]]]}},{"type": "Feature","geometry": {"type":"Polygon","coordinates":[[[-114.06579712541253,51.04941600065591],[-114.0644225745232,51.04843133257591],[-114.06302431506116,51.047443490347334],[-114.06291142870504,51.047365614541704],[-114.0601368168193,51.045432927615565],[-114.05822233602512,51.04414234683667],[-114.05372052037957,51.04210123085668],[-114.05345736935216,51.04192074280296],[-114.05317150211071,51.04205838188149],[-114.0497578,51.0442177],[-114.048536,51.043998],[-114.048012,51.043939],[-114.046877,51.04383],[-114.046661526967,51.04390164774268],[-114.04832,51.0469146],[-114.0452482,51.0491848],[-114.0446153,51.0491146],[-114.0438465,51.0490752],[-114.0431059,51.049066],[-114.0422801,51.0490595],[-114.0417403,51.0490394],[-114.0412125,51.0489987],[-114.0407367,51.0489378],[-114.0402634,51.0488584],[-114.0397601,51.0487438],[-114.0384158,51.0482438],[-114.0375776,51.0479345],[-114.03701142856407,51.04778079467866],[-114.03663722832738,51.048073459369725],[-114.0353423266778,51.05237839262024],[-114.03638494827545,51.053037197453214],[-114.0383797534819,51.05431821320227],[-114.03889361440156,51.054647452829954],[-114.0390314591959,51.05473587406665],[-114.03969247309942,51.05515933507],[-114.04339456150446,51.05813867651531],[-114.04727656566723,51.05877992211504],[-114.04870522465943,51.05965642517834],[-114.05081904217246,51.06061082021852],[-114.05536898846283,51.06134784038226],[-114.05572137317209,51.061079957522836],[-114.05625883192367,51.060629001749824],[-114.05932863262609,51.058414889191724],[-114.06003676798781,51.057950975205266],[-114.06005280166416,51.05789443589371],[-114.06005,51.0574973],[-114.06470785431681,51.056001043508566],[-114.06471329416591,51.055876338886634],[-114.06514918104098,51.05128601688869],[-114.06579712541253,51.04941600065591]]]}}]}
